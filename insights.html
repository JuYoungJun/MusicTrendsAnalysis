<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>데이터 분석 인사이트</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            background-color: #f9f9f9;
        }
        header {
            background-color: #007BFF;
            color: white;
            padding: 20px;
            text-align: center;
        }
        section {
            padding: 20px;
            margin: 20px auto;
            max-width: 900px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #007BFF;
        }
        ul {
            padding: 0;
            list-style: none;
        }
        ul li {
            background: #f4f4f4;
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <header>
        <h1>데이터 분석 인사이트</h1>
    </header>

    <!-- Longevity 데이터 인사이트 -->
    <section>
        <h2>1. Longevity 데이터</h2>
        <p>평균 스트림 수가 높은 상위 5곡:</p>
        <ul id="longevity-insights"></ul>
    </section>

    <!-- Rising Trends 데이터 인사이트 -->
    <section>
        <h2>2. Rising Trends 데이터</h2>
        <p>스트림 성장률이 높은 상위 5곡:</p>
        <ul id="rising-trends-insights"></ul>
    </section>

    <!-- Streams Distribution 데이터 인사이트 -->
    <section>
        <h2>3. Streams Distribution 데이터</h2>
        <p>상위 10곡 점유율이 높은 국가 상위 5개:</p>
        <ul id="streams-distribution-insights"></ul>
    </section>

    <!-- Top Tracks 데이터 인사이트 -->
    <section>
        <h2>4. Top Tracks 데이터</h2>
        <p>총 스트림 수가 높은 상위 5곡:</p>
        <ul id="top-tracks-insights"></ul>
    </section>

    <!-- D3.js Scripts -->
    <script>
        // Helper function to load CSV
        async function loadCSV(filePath) {
            const response = await fetch(filePath);
            const text = await response.text();
            return d3.csvParse(text);
        }

        // Longevity 데이터 인사이트
        loadCSV('final_data/longevity_top10.csv').then(data => {
            const insights = data.slice(0, 5); // 상위 5개
            const list = document.getElementById('longevity-insights');
            insights.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.track_name}: 평균 스트림 수 ${parseInt(item.avg_streams_per_week).toLocaleString()}회`;
                list.appendChild(li);
            });
        });

        // Rising Trends 데이터 인사이트
        loadCSV('final_data/rising_trends_top10.csv').then(data => {
            const insights = data.slice(0, 5); // 상위 5개
            const list = document.getElementById('rising-trends-insights');
            insights.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.track_name}: 성장률 ${item.stream_growth_rate}, 랭크 변화 ${item.rank_change}`;
                list.appendChild(li);
            });
        });

        // Streams Distribution 데이터 인사이트
        loadCSV('final_data/streams_distribution_top5.csv').then(data => {
            const insights = data.slice(0, 5); // 상위 5개
            const list = document.getElementById('streams-distribution-insights');
            insights.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.country}: 상위 10곡 점유율 ${item.top_10_share}%`;
                list.appendChild(li);
            });
        });

        // Top Tracks 데이터 인사이트
        loadCSV('final_data/top_tracks_top10.csv').then(data => {
            const insights = data.slice(0, 5); // 상위 5개
            const list = document.getElementById('top-tracks-insights');
            insights.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.track_name}: 총 스트림 수 ${parseInt(item.total_streams).toLocaleString()}회`;
                list.appendChild(li);
            });
        });
    </script>
</body>
</html>
